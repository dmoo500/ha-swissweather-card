# Home Assistant 2025.8+ Kompatibilit√§t

Diese SwissWeather Card ist speziell f√ºr Home Assistant 2025.8+ optimiert und nutzt die neuesten Features.

## Neue Features in HA 2025.8

### üîÑ **Moderne Entity-Struktur**
```typescript
// Die Card nutzt jetzt typisierte Entities
interface WeatherEntity extends HassEntity {
  attributes: {
    temperature: number;
    temperature_unit: string;
    humidity: number;
    pressure: number;
    wind_speed: number;
    wind_bearing: number;
    forecast: WeatherForecast[];
    // ... weitere Attribute
  };
}
```

### üé® **Verbesserte Theming-Unterst√ºtzung**
Die Card passt sich automatisch an das aktuelle HA-Theme an:

```yaml
# Lovelace-Konfiguration
type: custom:swissweather-card
entity: weather.home
theme: auto  # Automatische Theme-Erkennung
```

### ‚ö° **Performance-Optimierungen**
- **Lazy Loading** f√ºr bessere Performance
- **TypeScript** f√ºr bessere Typsicherheit
- **Modern ES2022** f√ºr neueste Browser-Features
- **Tree Shaking** f√ºr kleinere Bundle-Gr√∂√üe

## Installation f√ºr HA 2025.8+

### 1. **HACS Installation (Empfohlen)**
```yaml
# F√ºgen Sie dieses Repository zu HACS hinzu
https://github.com/your-username/ha-swissweather-card
```

### 2. **Manuelle Installation**
1. Laden Sie `swissweather-card.js` aus dem `dist/` Ordner herunter
2. Kopieren Sie es nach `config/www/`
3. F√ºgen Sie die Ressource hinzu:

```yaml
# configuration.yaml
lovelace:
  resources:
    - url: /local/swissweather-card.js
      type: module  # Wichtig: type: module f√ºr HA 2025.8+
```

### 3. **Konfiguration**
```yaml
# ui-lovelace.yaml oder Dashboard
type: custom:swissweather-card
entity: weather.openweathermap  # Oder Ihre Wetter-Entity
location: "Z√ºrich"
warning_entity: sensor.meteoswiss_warnings
wind_entity: sensor.wind_speed
wind_direction_entity: sensor.wind_bearing
sunshine_entity: sensor.sunshine_duration
show_forecast: true
show_warnings: true
compact_mode: false
```

## Neue Integrationen f√ºr 2025.8

### **Erweiterte MeteoSwiss-Integration**
```yaml
# configuration.yaml
meteoswiss:
  locations:
    - zip_code: 8001
      name: "Z√ºrich"
    - zip_code: 1201  
      name: "Genf"
  update_interval: 300  # 5 Minuten
  include_warnings: true
  include_forecasts: true
```

### **Verbesserte OpenWeatherMap**
```yaml
weather:
  - platform: openweathermap
    api_key: !secret openweather_api_key
    mode: "freedaily"  # Neuer kostenloser Modus
    language: de
    name: home
```

## Template-Sensoren f√ºr erweiterte Daten

### **Warnungen**
```yaml
template:
  - sensor:
      - name: "Wetter Warnungen"
        state: >
          {% set warnings = state_attr('weather.home', 'warnings') %}
          {% if warnings %}
            {{ warnings | length }}
          {% else %}
            0
          {% endif %}
        attributes:
          warnings: "{{ state_attr('weather.home', 'warnings') or [] }}"
          highest_level: >
            {% set warnings = state_attr('weather.home', 'warnings') or [] %}
            {% if warnings %}
              {{ warnings | map(attribute='level') | max }}
            {% else %}
              0
            {% endif %}
```

### **Erweiterte Wind-Daten**
```yaml
template:
  - sensor:
      - name: "Wind B√∂en"
        unit_of_measurement: "km/h"
        state: >
          {% set wind_speed = states('sensor.wind_speed') | float(0) %}
          {% set wind_factor = 1.3 %}  # B√∂enfaktor
          {{ (wind_speed * wind_factor) | round(1) }}
        
      - name: "Wind Beaufort"
        state: >
          {% set speed = states('sensor.wind_speed') | float(0) %}
          {% if speed < 1 %}0
          {% elif speed < 6 %}1
          {% elif speed < 12 %}2
          {% elif speed < 20 %}3
          {% elif speed < 29 %}4
          {% elif speed < 39 %}5
          {% elif speed < 50 %}6
          {% elif speed < 62 %}7
          {% elif speed < 75 %}8
          {% elif speed < 89 %}9
          {% elif speed < 103 %}10
          {% elif speed < 118 %}11
          {% else %}12
          {% endif %}
```

## Automatisierungen

### **Wetterwarnung-Benachrichtigung**
```yaml
automation:
  - alias: "Wetterwarnung Benachrichtigung"
    trigger:
      - platform: state
        entity_id: sensor.meteoswiss_warnings
        attribute: highest_level
    condition:
      - condition: numeric_state
        entity_id: sensor.meteoswiss_warnings
        attribute: highest_level
        above: 2
    action:
      - service: notify.mobile_app
        data:
          title: "‚ö†Ô∏è Wetterwarnung"
          message: >
            Warnstufe {{ state_attr('sensor.meteoswiss_warnings', 'highest_level') }}
            f√ºr {{ state_attr('sensor.meteoswiss_warnings', 'location') }}
```

## Fehlerbehebung

### **Card l√§dt nicht**
1. Pr√ºfen Sie die Browser-Konsole (F12)
2. Stellen Sie sicher, dass `type: module` verwendet wird
3. √úberpr√ºfen Sie die Entity-Namen

### **Keine Warnungen angezeigt**
1. √úberpr√ºfen Sie die Warnung-Entity-Struktur
2. Testen Sie mit Developer Tools ‚Üí States
3. Stellen Sie sicher, dass Warnungen als Array vorliegen

### **Performance-Probleme**
1. Aktivieren Sie `compact_mode: true`
2. Deaktivieren Sie nicht ben√∂tigte Features
3. Pr√ºfen Sie die Browser-Kompatibilit√§t (ES2022 erforderlich)

## Entwicklung

### **TypeScript-Build**
```bash
yarn install
yarn type-check  # TypeScript-Pr√ºfung
yarn build       # Production Build
yarn dev         # Development mit Watch
```

### **Linting & Formatting**
```bash
yarn lint        # ESLint-Pr√ºfung
yarn format      # Prettier-Formatierung
```
